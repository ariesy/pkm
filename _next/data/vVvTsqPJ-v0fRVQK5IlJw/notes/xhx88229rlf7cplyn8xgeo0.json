{"pageProps":{"note":{"id":"xhx88229rlf7cplyn8xgeo0","title":"Create Init.d Script","desc":"","tags":["linux","init_d"],"updated":1698744798284,"created":1698739588527,"custom":{},"fname":"software-engineer.linux.create-init_d-script","type":"note","vault":{"fsPath":".","selfContained":true,"name":"pkm"},"contentHash":"7b5116ec426a419529ee77dd2be1d0ae","links":[{"type":"frontmatterTag","from":{"fname":"software-engineer.linux.create-init_d-script","id":"xhx88229rlf7cplyn8xgeo0","vaultName":"pkm"},"value":"tags.linux","alias":"linux","xvault":false,"to":{"fname":"tags.linux"}},{"type":"frontmatterTag","from":{"fname":"software-engineer.linux.create-init_d-script","id":"xhx88229rlf7cplyn8xgeo0","vaultName":"pkm"},"value":"tags.init_d","alias":"init_d","xvault":false,"to":{"fname":"tags.init_d"}}],"anchors":{"sample-service-script-for-debianubuntu":{"type":"header","text":"Sample service script for debian/ubuntu","value":"sample-service-script-for-debianubuntu","line":10,"column":0,"depth":2},"usage":{"type":"header","text":"Usage","value":"usage","line":14,"column":0,"depth":2},"test-the-service":{"type":"header","text":"Test the service","value":"test-the-service","line":34,"column":0,"depth":2},"run-at-boot-time":{"type":"header","text":"Run at boot-time","value":"run-at-boot-time","line":41,"column":0,"depth":2},"uninstall":{"type":"header","text":"Uninstall","value":"uninstall","line":47,"column":0,"depth":2},"logs":{"type":"header","text":"Logs?","value":"logs","line":53,"column":0,"depth":2},"problems":{"type":"header","text":"Problems","value":"problems","line":57,"column":0,"depth":2},"auto-create-new-service":{"type":"header","text":"auto create new service","value":"auto-create-new-service","line":76,"column":0,"depth":2},"reference":{"type":"header","text":"reference","value":"reference","line":80,"column":0,"depth":2}},"children":[],"parent":"17v6equ3zmuv4vr4f8cnq8n","data":{}},"body":"<h1 id=\"create-initd-script\">Create Init.d Script<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#create-initd-script\"></a></h1>\n<h2 id=\"sample-service-script-for-debianubuntu\">Sample service script for debian/ubuntu<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sample-service-script-for-debianubuntu\"></a></h2>\n<p>Look at <a href=\"http://wiki.debian.org/LSBInitScripts\">LSB init scripts</a> for more information.</p>\n<h2 id=\"usage\">Usage<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#usage\"></a></h2>\n<p>Copy <a href=\"/assets/scripts/service.sh\">service.sh</a> to <code>/etc/init.d</code>:</p>\n<pre class=\"language-sh\"><code class=\"language-sh\"># replace \"$YOUR_SERVICE_NAME\" with your service's name\ncp \"service.sh\" \"/etc/init.d/$YOUR_SERVICE_NAME\"\nchmod +x /etc/init.d/$YOUR_SERVICE_NAME\nchown root /etc/init.d/$YOUR_SERVICE_NAME\nchgrp root /etc/init.d/$YOUR_SERVICE_NAME\n</code></pre>\n<p>Edit the script and replace following tokens:</p>\n<ul>\n<li><code>&#x3C;NAME></code> = <code>$YOUR_SERVICE_NAME</code></li>\n<li><code>&#x3C;DESCRIPTION></code> = Describe your service here (be concise)</li>\n<li>Feel free to modify the LSB header, I've made default choices you may not agree with</li>\n<li><code>&#x3C;COMMAND></code> = Command to start your server (for example <code>/home/myuser/.dropbox-dist/dropboxd</code>)</li>\n<li><code>&#x3C;USER></code> = Login of the system user the script should be run as (for example <code>myuser</code>)</li>\n</ul>\n<h2 id=\"test-the-service\">Test the service<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#test-the-service\"></a></h2>\n<pre class=\"language-sh\"><code class=\"language-sh\">service $YOUR_SERVICE_NAME start\nservice $YOUR_SERVICE_NAME stop\n</code></pre>\n<h2 id=\"run-at-boot-time\">Run at boot-time<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#run-at-boot-time\"></a></h2>\n<pre class=\"language-sh\"><code class=\"language-sh\">update-rc.d $YOUR_SERVICE_NAME defaults\n</code></pre>\n<h2 id=\"uninstall\">Uninstall<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#uninstall\"></a></h2>\n<p>The service can uninstall itself with <code>service $NAME uninstall</code>. Yes, that's very easy, therefore a bit dangerous. But as it's an auto-generated script, you can bring it back very easily. I use it for tests and often install/uninstall, that's why I've put that here.</p>\n<p>Don't want it? Remove lines 56-58 of the service's script.</p>\n<h2 id=\"logs\">Logs?<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#logs\"></a></h2>\n<p>Your service will log its output to <code>/var/log/$NAME.log</code>. Don't forget to setup a logrotate :)</p>\n<h2 id=\"problems\">Problems<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#problems\"></a></h2>\n<p><code>unable to execute /etc/init.d/$YOUR_SERVICE_NAME: No such file or directory.</code></p>\n<p>Maybe it has been modified by a Windows's editor and the line endings could be not corrected.\nThis can be verified with the command <code>cat -v service.sh</code> and verifying that there are some strange characters as <code>^M</code>.</p>\n<p>To fix that:</p>\n<p><code>sed -i 's/\\r//g' service.sh</code></p>\n<p><code>Failed to start xxx.service: Unit xxx.service not found.</code></p>\n<p>to fix that:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl <span class=\"token builtin class-name\">enable</span> xxx\n</code></pre>\n<h2 id=\"auto-create-new-service\">auto create new service<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#auto-create-new-service\"></a></h2>\n<p>Using <a href=\"/assets/scripts/new_service.sh\">new_service.sh</a> to auto create new service.</p>\n<h2 id=\"reference\">reference<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#reference\"></a></h2>\n<p><a href=\"https://gist.github.com/miromannino/a17f3e6f3fdcb4d94a1f\">https://gist.github.com/miromannino/a17f3e6f3fdcb4d94a1f</a></p>\n<hr>\n<h2 id=\"tags\">Tags<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tags\"></a></h2>\n<ol>\n<li><a class=\"color-tag\" style=\"--tag-color: #39ad48;\" href=\"/notes/ffcimh0qyzmo6rxrxjqos5h\">#linux</a></li>\n<li><a class=\"color-tag\" style=\"--tag-color: #bc13fe;\" href=\"/notes/lfov4p3lf9ta8k8t159ajpq\">#init_d</a></li>\n</ol>","noteIndex":{"id":"9tq2uj2rkjq6qd08ftir0mx","title":"My Personal Knowledge Management Vault","desc":"","updated":1697608261505,"created":1697598431220,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"pkm"},"contentHash":"7d27f5e114ea2221af0ae8fa7842a851","links":[],"anchors":{"welcome-to-dendron":{"type":"header","text":"Welcome to Dendron","value":"welcome-to-dendron","line":7,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":11,"column":0,"depth":2}},"children":["szxr9zpeiknws64jt9pukac","kqmdg2z40yjosenvccpq0u1","wbzzi4bmw5c8bpmdf0bvnuv"],"parent":null,"data":{},"body":"# Welcome to Dendron\n\nThis is my personal knowledge management vault.\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Home Page](https://pkm.zhu-kun.com/)\n- [Github](https://github.com/ariesy/pkm)"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true,"enableExportPodV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"pkm"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enablePersistentHistory":false,"seeds":{"dendron.templates":{}}},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":true},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal Knowledge Space","author":"Kun Zhu"},"github":{"cname":"pkm.zhu-kun.com","enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"master","editViewMode":"tree","editRepository":"https://github.com/ariesy/pkm"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":true,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://pkm.zhu-kun.com","duplicateNoteBehavior":{"action":"useVault","payload":["pkm"]},"enableHierarchyDisplay":true,"enableBackLinks":true,"hierarchyDisplayTitle":"Children","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}